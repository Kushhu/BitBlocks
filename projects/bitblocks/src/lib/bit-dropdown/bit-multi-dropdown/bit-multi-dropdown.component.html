<div class="bit-dropdown-wrapper">

    <div class="bit-textbox bit-multi-dropdown" tabindex="0" 
        [style.minHeight]="'calc( 13px + 1.5rem * '+ minHeight() + ')' "
        [class.bit-input-valid]="valid === true"
        [class.bit-input-invalid]="valid === false" 
        (click)="openDrop()" (focus)="openDrop()">

        @if (isLoading()) { <span class="bit-dropdown-placeholder"> Loading...  </span> }

        @else if (valid === false && value != null) {
            <span class="bit-dropdown-placeholder">
                Invalid Option : 
                @for (item of setOfValues.values(); track $index) { 
                    {{ item }} 
                } 
            </span>
        }

        @else if (placeholder() && !selectedOption?.length) {  
            <span class="bit-dropdown-placeholder"> {{ placeholder() }} </span> 
        }
       
        @else {
            <div class="visible-list">

                @for (option of selectedOption; track $index;let last = $last) {
                    <span class="visible-item" (dblclick)="remove(option.nativeElement.innerText)">
                        {{option.nativeElement.children.item(0)?.ariaLabel ?? option.nativeElement.innerText}} 
                    </span>@if(!last) {, }
                }

            </div>
        }

        <span class="selected-records-count">{{selectedOption?.length}}</span>
    </div>

    @if (isOpen) {
    <div class="bit-option-list">

        <input #searchEle type="text" [placeholder]="searchPlaceholder()" class="bit-textbox" autocomplete="off"
            [(ngModel)]="search" (input)="onInput(searchEle)" 
            (keydown.tab)="closeDrop()" 
            [hidden]="!isSearchable() || !isOpen">

        @if (noSearchAvailable) { <div class="bit-empty-option"> ðŸ˜’ No Matches </div> }

        @if (isLoading()) { <div class="bit-empty-option"> Loading... </div> }

        <ng-content select="bit-option, bit-checked-option"></ng-content>

    </div>
    }

</div>